<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Challenge — Auth</title>
    <meta name="color-scheme" content="dark" />
    <style>
      :root {
        --bg-1: #031028;
        --bg-2: #05264a;
        --bg-3: #083a6d;
        --card: rgba(255, 255, 255, 0.04);
        --muted: rgba(255, 255, 255, 0.68);
        --text: #e6f0ff;
        --accent: #67a7ff;
        --shadow: 0 10px 30px rgba(3, 18, 40, 0.6);
        --font-sans: Inter, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: var(--font-sans);
        color: var(--text);
        background: radial-gradient(
            1200px 800px at 10% 10%,
            rgba(103, 156, 255, 0.06),
            transparent 10%
          ),
          radial-gradient(
            900px 500px at 90% 90%,
            rgba(40, 120, 255, 0.04),
            transparent 8%
          ),
          linear-gradient(
            180deg,
            var(--bg-1) 0%,
            var(--bg-2) 40%,
            var(--bg-3) 100%
          );
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 28px;
        overflow: hidden;
      }

      /* Background / parallax blobs */
      .bg {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
        overflow: hidden;
      }
      .blob {
        position: absolute;
        border-radius: 50%;
        filter: blur(48px);
        opacity: 0.12;
        animation: floaty 8s ease-in-out infinite alternate;
        mix-blend-mode: screen;
      }
      .b1 {
        background: radial-gradient(
          circle at 30% 30%,
          rgba(103, 167, 255, 0.9),
          rgba(103, 167, 255, 0.2)
        );
        left: -10%;
        top: -12%;
        width: 420px;
        height: 420px;
        opacity: 0.16;
        animation-duration: 10s;
      }
      .b2 {
        background: radial-gradient(
          circle at 70% 70%,
          rgba(32, 110, 255, 0.75),
          rgba(32, 110, 255, 0.08)
        );
        right: -6%;
        bottom: -8%;
        width: 520px;
        height: 520px;
        opacity: 0.1;
        animation-duration: 12s;
      }
      .b3 {
        background: radial-gradient(
          circle at 50% 50%,
          rgba(110, 200, 255, 0.6),
          rgba(110, 200, 255, 0.04)
        );
        left: 30%;
        bottom: 10%;
        width: 300px;
        height: 300px;
        opacity: 0.08;
        animation-duration: 14s;
      }
      @keyframes floaty {
        from {
          transform: translateY(-10px);
        }
        to {
          transform: translateY(12px);
        }
      }

      .eye {
        position: absolute;
        left: 50%;
        top: 35%;
        width: 520px;
        height: 520px;
        transform: translate(-50%, -50%);
        pointer-events: none;
        z-index: 1;
        mix-blend-mode: screen;
      }
      .iris {
        position: absolute;
        left: 50%;
        top: 50%;
        width: 260px;
        height: 260px;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        background: radial-gradient(
          circle at 35% 35%,
          rgba(140, 190, 255, 0.95) 0%,
          rgba(90, 150, 255, 0.12) 30%,
          transparent 60%
        );
        filter: blur(36px);
        transition: transform 0.12s linear;
      }

      /* Card */
      .card {
        width: 100%;
        max-width: 920px;
        background: rgba(255, 255, 255, 0.02);
        border-radius: 12px;
        box-shadow: var(--shadow);
        display: grid;
        grid-template-columns: 1fr 420px;
        overflow: hidden;
        position: relative;
        z-index: 5;
        border: 1px solid rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(6px) saturate(1.05);
        animation: fadeIn 0.36s ease both;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(6px);
        }
        to {
          opacity: 1;
          transform: none;
        }
      }
      .panel {
        padding: 28px;
      }
      .hero {
        display: flex;
        flex-direction: column;
        gap: 12px;
        justify-content: center;
        padding: 24px;
      }
      .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 700;
        font-size: 22px;
        letter-spacing: 0.2px;
        color: var(--accent);
      }
      .brand svg {
        width: 28px;
        height: 28px;
        filter: drop-shadow(0 0 8px rgba(103, 167, 255, 0.6));
      }
      .lead {
        color: var(--muted);
        margin: 0;
        max-width: 360px;
      }
      /* Motivational quote area */
      .quote {
        margin-top: 10px;
        font-size: 13px;
        color: var(--muted);
        min-height: 20px;
        line-height: 1.2;
      }
      .quote .text {
        display: inline-block;
        white-space: nowrap;
        overflow: hidden;
        vertical-align: bottom;
      }
      .quote .cursor {
        display: inline-block;
        width: 10px;
        height: 18px;
        margin-left: 6px;
        background: var(--accent);
        border-radius: 2px;
        vertical-align: bottom;
        opacity: 0.9;
        animation: blink 1s steps(2, start) infinite;
      }
      @keyframes blink {
        50% {
          opacity: 0;
        }
      }

      .forms {
        padding: 24px;
      }
      .tabs {
        display: flex;
        gap: 8px;
        margin-bottom: 16px;
      }
      .tab {
        padding: 8px 12px;
        border-radius: 10px;
        cursor: pointer;
        user-select: none;
        font-weight: 700;
        color: var(--muted);
        border: 1px solid transparent;
        transition: all 0.12s ease;
      }
      .tab.active {
        background: rgba(103, 167, 255, 0.12);
        color: var(--accent);
        border-color: rgba(103, 167, 255, 0.12);
        transform: translateY(-2px);
      }
      .field {
        margin-bottom: 12px;
        position: relative;
      }
      label {
        display: block;
        margin-bottom: 6px;
        font-size: 13px;
        color: var(--muted);
      }
      input {
        width: 100%;
        padding: 12px 36px 12px 36px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.03);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text);
        font-size: 14px;
        outline: none;
        transition: border 0.12s, box-shadow 0.12s;
      }
      input:focus {
        border-color: rgba(103, 167, 255, 0.25);
        box-shadow: 0 0 12px rgba(103, 167, 255, 0.08);
      }
      .icon {
        position: absolute;
        left: 12px;
        top: 36px;
        width: 16px;
        height: 16px;
        opacity: 0.8;
      }
      .actions {
        margin-top: 16px;
        display: flex;
        gap: 8px;
        align-items: center;
      }
      button {
        padding: 10px 14px;
        border-radius: 10px;
        border: 0;
        font-weight: 700;
        cursor: pointer;
        transition: transform 0.12s;
      }
      .btn-primary {
        background: linear-gradient(180deg, var(--accent), #2f7be6);
        color: white;
        box-shadow: 0 8px 28px rgba(45, 93, 175, 0.28);
      }
      .btn-primary:active {
        transform: translateY(1px);
      }
      .btn-ghost {
        background: transparent;
        color: var(--muted);
        border: 1px solid rgba(255, 255, 255, 0.03);
        padding: 8px 12px;
        border-radius: 8px;
      }
      .error {
        color: #ff7b7b;
        font-size: 13px;
        margin-top: 8px;
      }
      .success {
        color: #8ef1a7;
        font-size: 13px;
        margin-top: 8px;
      }

      /* Mobile responsiveness: single column, centered brand, quotes displayed below brand */
      @media (max-width: 860px) {
        body {
          padding: 18px;
        }
        .card {
          grid-template-columns: 1fr;
          max-width: 420px;
        }
        .hero {
          order: 1;
          padding: 18px;
          align-items: center;
          text-align: center;
        }
        .forms {
          order: 2;
          padding: 18px;
        }
        .eye {
          display: none;
        }
        .brand {
          justify-content: center;
        }
        .quote {
          min-height: 40px;
        }
        .icon {
          top: 34px;
        }
      }

      /* Respect reduced motion: remove blinking cursor and long transitions */
      @media (prefers-reduced-motion: reduce) {
        .quote .cursor {
          animation: none;
        }
        * {
          transition-duration: 0.01ms !important;
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="bg" aria-hidden="true">
      <div class="blob b1"></div>
      <div class="blob b2"></div>
      <div class="blob b3"></div>
      <div class="eye" aria-hidden="true">
        <div class="iris" id="iris"></div>
      </div>
    </div>

    <main class="card" role="main" aria-label="Authentication">
      <section class="hero panel">
        <div class="brand" aria-hidden="false">
          <!-- Challenge logo -->
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <circle
              cx="12"
              cy="12"
              r="9"
              stroke="currentColor"
              stroke-width="2"
            />
            <path d="M8 12h8M12 8v8" stroke="currentColor" stroke-width="2" />
          </svg>
          Challenge
        </div>

        <!-- Motivational quote area -->
        <div class="quote" aria-live="polite" aria-atomic="true">
          <span class="text" id="quote-text"></span
          ><span class="cursor" id="quote-cursor" aria-hidden="true"></span>
        </div>

        <p class="lead">
          Sign in or create your Challenge account to continue.
        </p>
      </section>

      <section class="forms panel">
        <div class="tabs" role="tablist" aria-label="Auth Tabs">
          <div
            id="tab-login"
            class="tab active"
            role="tab"
            aria-selected="true"
            tabindex="0"
          >
            Login
          </div>
          <div
            id="tab-register"
            class="tab"
            role="tab"
            aria-selected="false"
            tabindex="0"
          >
            Register
          </div>
        </div>

        <!-- Login Form (Demo button removed as requested) -->
        <form id="form-login" novalidate>
          <div class="field">
            <label for="login-email">Email</label>
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              aria-hidden="true"
            >
              <path
                d="M4 4h16v16H4z"
                stroke="currentColor"
                stroke-width="1.5"
                opacity=".2"
              />
              <path d="M4 4l8 8 8-8" stroke="currentColor" stroke-width="1.5" />
            </svg>
            <input
              id="login-email"
              name="email"
              type="email"
              placeholder="you@example.com"
              autocomplete="email"
              required
            />
          </div>

          <div class="field">
            <label for="login-password">Password</label>
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              aria-hidden="true"
            >
              <rect
                x="5"
                y="11"
                width="14"
                height="10"
                rx="2"
                stroke="currentColor"
                stroke-width="1.5"
              />
              <path
                d="M9 11V7a3 3 0 0 1 6 0v4"
                stroke="currentColor"
                stroke-width="1.5"
              />
            </svg>
            <input
              id="login-password"
              name="password"
              type="password"
              placeholder="••••••••"
              autocomplete="current-password"
              required
            />
          </div>

          <div class="actions">
            <button id="login-submit" class="btn-primary" type="submit">
              Sign in
            </button>
            <button
              id="forgot"
              type="button"
              class="btn-ghost"
              aria-label="Forgot password"
            >
              Forgot?
            </button>
          </div>

          <div id="login-msg" role="status" aria-live="polite"></div>
        </form>

        <!-- Register Form -->
        <form id="form-register" style="display: none" novalidate>
          <div class="field">
            <label for="reg-name">Full Name</label>
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              aria-hidden="true"
            >
              <circle
                cx="12"
                cy="8"
                r="4"
                stroke="currentColor"
                stroke-width="1.5"
              />
              <path
                d="M4 20c1-4 15-4 16 0"
                stroke="currentColor"
                stroke-width="1.5"
              />
            </svg>
            <input
              id="reg-name"
              name="name"
              type="text"
              placeholder="John Doe"
              autocomplete="name"
              required
            />
          </div>

          <div class="field">
            <label for="reg-email">Email</label>
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              aria-hidden="true"
            >
              <path
                d="M4 4h16v16H4z"
                stroke="currentColor"
                stroke-width="1.5"
                opacity=".2"
              />
              <path d="M4 4l8 8 8-8" stroke="currentColor" stroke-width="1.5" />
            </svg>
            <input
              id="reg-email"
              name="email"
              type="email"
              placeholder="you@example.com"
              autocomplete="email"
              required
            />
          </div>

          <div class="field">
            <label for="reg-password">Password</label>
            <svg
              class="icon"
              viewBox="0 0 24 24"
              fill="none"
              aria-hidden="true"
            >
              <rect
                x="5"
                y="11"
                width="14"
                height="10"
                rx="2"
                stroke="currentColor"
                stroke-width="1.5"
              />
              <path
                d="M9 11V7a3 3 0 0 1 6 0v4"
                stroke="currentColor"
                stroke-width="1.5"
              />
            </svg>
            <input
              id="reg-password"
              name="password"
              type="password"
              placeholder="At least 8 characters"
              autocomplete="new-password"
              required
            />
          </div>

          <div class="actions">
            <button id="reg-submit" class="btn-primary" type="submit">
              Create account
            </button>
            <button id="reg-cancel" class="btn-ghost" type="button">
              Cancel
            </button>
          </div>

          <div id="reg-msg" role="status" aria-live="polite"></div>
        </form>
      </section>
    </main>

    <script>
      (function () {
        // Utility selectors
        const qs = (s, c = document) => c.querySelector(s);
        const qsa = (s, c = document) => Array.from(c.querySelectorAll(s));

        // Tabs & forms
        const tabLogin = qs("#tab-login");
        const tabRegister = qs("#tab-register");
        const formLogin = qs("#form-login");
        const formRegister = qs("#form-register");

        function showLogin() {
          tabLogin.classList.add("active");
          tabLogin.setAttribute("aria-selected", "true");
          tabRegister.classList.remove("active");
          tabRegister.setAttribute("aria-selected", "false");
          formLogin.style.display = "";
          formLogin.setAttribute("aria-hidden", "false");
          formRegister.style.display = "none";
          formRegister.setAttribute("aria-hidden", "true");
        }
        function showRegister() {
          tabRegister.classList.add("active");
          tabRegister.setAttribute("aria-selected", "true");
          tabLogin.classList.remove("active");
          tabLogin.setAttribute("aria-selected", "false");
          formRegister.style.display = "";
          formRegister.setAttribute("aria-hidden", "false");
          formLogin.style.display = "none";
          formLogin.setAttribute("aria-hidden", "true");
        }
        tabLogin.addEventListener("click", showLogin);
        tabRegister.addEventListener("click", showRegister);
        [tabLogin, tabRegister].forEach((t) =>
          t.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              t.click();
            }
          })
        );

        // Basic validation helpers & API placeholder
        function isEmail(v) {
          return /^\S+@\S+\.\S+$/.test(v);
        }
        async function apiPost(endpoint, body) {
          // placeholder; keep as-is for backend wiring
          return fetch(endpoint, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(body),
          });
        }

        // Login submit
        formLogin.addEventListener("submit", async (e) => {
          e.preventDefault();
          const email = qs("#login-email").value.trim();
          const password = qs("#login-password").value;
          const msg = qs("#login-msg");
          if (msg) msg.innerHTML = "";

          if (!email || !password) {
            if (msg)
              msg.innerHTML =
                '<div class="error">Please enter both email and password.</div>';
            return;
          }
          if (!isEmail(email)) {
            if (msg)
              msg.innerHTML =
                '<div class="error">Please enter a valid email address.</div>';
            return;
          }

          const btn = qs("#login-submit");
          if (btn) {
            btn.disabled = true;
            btn.textContent = "Signing in...";
          }
          try {
            const resp = await apiPost("/api/auth/login", { email, password });
            if (!resp.ok) {
              let err = "Sign in failed.";
              try {
                const d = await resp.json();
                if (d?.message) err = d.message;
              } catch (e) {}
              if (msg) msg.innerHTML = `<div class="error">${err}</div>`;
            } else {
              if (msg)
                msg.innerHTML = `<div class="success">Signed in (placeholder)</div>`;
            }
          } catch (err) {
            if (msg)
              msg.innerHTML = `<div class="error">Network error. Check backend.</div>`;
          } finally {
            if (btn) {
              btn.disabled = false;
              btn.textContent = "Sign in";
            }
          }
        });

        // Register submit
        formRegister.addEventListener("submit", async (e) => {
          e.preventDefault();
          const name = qs("#reg-name").value.trim();
          const email = qs("#reg-email").value.trim();
          const password = qs("#reg-password").value;
          const msg = qs("#reg-msg");
          if (msg) msg.innerHTML = "";

          if (!name) {
            if (msg)
              msg.innerHTML =
                '<div class="error">Please enter your full name.</div>';
            return;
          }
          if (!email || !isEmail(email)) {
            if (msg)
              msg.innerHTML =
                '<div class="error">Please enter a valid email address.</div>';
            return;
          }
          if (!password || password.length < 8) {
            if (msg)
              msg.innerHTML =
                '<div class="error">Password must be at least 8 characters.</div>';
            return;
          }

          const btn = qs("#reg-submit");
          if (btn) {
            btn.disabled = true;
            btn.textContent = "Creating...";
          }
          try {
            const resp = await apiPost("/api/auth/register", {
              name,
              email,
              password,
            });
            if (!resp.ok) {
              let err = "Registration failed.";
              try {
                const d = await resp.json();
                if (d?.message) err = d.message;
              } catch (e) {}
              if (msg) msg.innerHTML = `<div class="error">${err}</div>`;
            } else {
              if (msg)
                msg.innerHTML = `<div class="success">Account created. You can now sign in.</div>`;
              qs("#login-email").value = email;
              qs("#login-password").value = "";
              showLogin();
            }
          } catch (err) {
            if (msg)
              msg.innerHTML = `<div class="error">Network error. Check backend.</div>`;
          } finally {
            if (btn) {
              btn.disabled = false;
              btn.textContent = "Create account";
            }
          }
        });

        qs("#reg-cancel").addEventListener("click", showLogin);

        // Accessibility: initial focus
        qs("#login-email")?.focus();

        /* Parallax eye + blobs */
        const iris = qs("#iris");
        const blobs = qsa(".blob");
        let target = { x: 0, y: 0 },
          last = { x: 0, y: 0 };
        const ease = 0.08,
          maxIris = 22,
          maxBlob = 36;
        function updateTarget(clientX, clientY) {
          target.x = (clientX / window.innerWidth - 0.5) * 2;
          target.y = (clientY / window.innerHeight - 0.5) * 2;
        }
        window.addEventListener(
          "mousemove",
          (e) => updateTarget(e.clientX, e.clientY),
          { passive: true }
        );
        window.addEventListener(
          "touchmove",
          (e) => {
            if (e.touches && e.touches[0])
              updateTarget(e.touches[0].clientX, e.touches[0].clientY);
          },
          { passive: true }
        );
        window.addEventListener("mouseleave", () => {
          target.x = 0;
          target.y = 0;
        });
        function raf() {
          last.x += (target.x - last.x) * ease;
          last.y += (target.y - last.y) * ease;
          if (iris)
            iris.style.transform = `translate(calc(-50% + ${
              last.x * maxIris
            }px), calc(-50% + ${last.y * maxIris * 0.7}px))`;
          blobs.forEach((b, i) => {
            const depth = (i + 1) / blobs.length;
            const bx = -last.x * maxBlob * depth;
            const by = -last.y * (maxBlob * 0.6) * depth;
            b.style.transform = `translate3d(${bx}px, ${by}px, 0)`;
          });
          requestAnimationFrame(raf);
        }
        requestAnimationFrame(raf);

        /* ---------------------------------------
         Motivational quotes: typing animation
         - Quotes rotate; typing per-letter
         - Pause between quotes is randomized 3000-4000ms
         - Typing speed per letter: 40ms (respected by reduced-motion)
         ---------------------------------------*/
        const quotes = [
          "Keep pushing — small steps win races.",
          "One more push. You’ve got this.",
          "Learn fast. Ship faster.",
          "Progress > Perfection.",
        ];
        const quoteTextEl = qs("#quote-text");
        const cursorEl = qs("#quote-cursor");
        let qIndex = 0;
        let typing = true;
        const baseTypeSpeed = 40; // ms per letter
        const minPause = 3000,
          maxPause = 4000; // ms between quotes

        // respect prefers-reduced-motion
        const reduce = window.matchMedia(
          "(prefers-reduced-motion: reduce)"
        ).matches;
        const typeSpeed = reduce ? 1 : baseTypeSpeed;
        if (reduce && cursorEl) {
          cursorEl.style.display = "none";
        }

        async function sleep(ms) {
          return new Promise((r) => setTimeout(r, ms));
        }

        async function typeQuote(text) {
          quoteTextEl.textContent = "";
          for (let i = 0; i < text.length; i++) {
            quoteTextEl.textContent += text[i];
            // small jitter for cursor (already animates); respect reduced motion
            await sleep(typeSpeed);
          }
        }

        async function rotateQuotes() {
          while (true) {
            const text = quotes[qIndex % quotes.length];
            await typeQuote(text);
            // pause with full text visible
            const pause =
              Math.floor(Math.random() * (maxPause - minPause)) + minPause;
            await sleep(pause);
            // simple delete effect (reverse)
            if (!reduce) {
              for (let i = text.length; i > 0; i--) {
                quoteTextEl.textContent = text.slice(0, i - 1);
                await sleep(18);
              }
            } else {
              quoteTextEl.textContent = "";
              await sleep(200);
            }
            qIndex++;
          }
        }
        // start after small initial delay so UI paints first
        setTimeout(() => rotateQuotes(), 500);
      })();
    </script>
  </body>
</html>
